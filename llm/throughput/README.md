# MosaicGPT Throughput, MFU, and HFU
Throughput, MFU, and HFU for different sized MosaicGPT models trained on MCloud.
MFU and HFU are defined in https://arxiv.org/abs/2205.05198
All FLOP calculations do not include norm, act, and residual.

MFU approximation:
Using only the parameters, per token, each parameter is used for a MAC (2 FLOPS) per network operation. Neural Network training has 4 network operations: forward pass, backward pass, and computation of parameter gradient.
The attention mechanism also has a forward pass and backward pass where `attn_flops_per_seq = n_layers * 2 * (d_model * (seq_len**2))`.
```
flops_per_token = 2 * n_params
flops_per_seq = flops_per_token * seq_len
mfu* = 3 * flops_per_seq * throughput / (gpu_num * GPU_AVAILABLE_FLOPS)

attn_flops_per_seq = n_layers * 2 * (d_model * (seq_len**2))
mfu = (3 * flops_per_seq + 2 * attn_flops_per_seq) * throughput / (gpu_num * GPU_AVAILABLE_FLOPS)
```

HFU is approximated using the fact that the networks use checkpointing for activation recomputation. This effectively requires an extra forward pass through the network.
```
hfu* = 4 * flops_per_seq * throughput / (gpu_num * GPU_AVAILABLE_FLOPS)
hfu = (4 * flops_per_seq + 3 * attn_flops_per_seq) * throughput / (gpu_num * GPU_AVAILABLE_FLOPS)
```

These are approximations. Real HFU would be higher since it would include the FLOP usage of norm, act, residual, as well as account for ALL recomputation (the model uses FlashAttn which already does a recomputation in the fwd pass; in reality, the hfu attn multiplier should be 5 instaed of 3).

Below we highlight some of the configurations, but the full tables can be found in [FULL_TABLES](./FULL_TABLES.md)

## A100 80GB

| Model   | SeqLen (T) | GPUType       | MFU*   | MFU    | HFU*   | HFU    | Throughput (T/s) | GPUThroughput (T/s/GPU) | Throughput (S/s) | ParamCount  | GlobalBatchSize (T) | GlobalBatchSize (S) | MicroBatchSize (S) | GradAccum | ShardStrategy | ActCkpt | ActCPUoffload | Precision | MP Mode | NumGPUs | GPUType   |
| ------- | ---------- | ------------- | ------ | ------ | ------ | ------ | ---------------- | ----------------------- | ---------------- | ----------- | ------------------- | ------------------- | ------------------ | --------- | ------------- | ------- | ------------- | --------- | ------- | ------- | --------- |
|  gpt70b |       2048 | 128xA100_80GB | 0.4096 | 0.4152 | 0.5461 | 0.5546 |         42028.81 |                328.3501 |          20.5219 | 64861528064 |             2097152 |                1024 |                  8 |         1 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |     128 | a100_80gb |
|  gpt30b |       8192 |  64xA100_80GB | 0.3790 | 0.4028 | 0.5054 | 0.5410 |         42023.16 |                656.6118 |           5.1298 | 30018458624 |             1048576 |                 128 |                  2 |         1 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |      64 | a100_80gb |
|  gpt30b |       8192 |  32xA100_80GB | 0.3734 | 0.3968 | 0.4979 | 0.5329 |         20698.23 |                646.8198 |           2.5266 | 30018458624 |              524288 |                  64 |                  2 |         1 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |      32 | a100_80gb |
|  gpt30b |       8192 |  16xA100_80GB | 0.3823 | 0.4062 | 0.5097 | 0.5456 |         10595.78 |                662.2362 |           1.2934 | 30018458624 |              262144 |                  32 |                  2 |         1 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |      16 | a100_80gb |
|  gpt30b |       4096 | 128xA100_80GB | 0.4249 | 0.4382 | 0.5666 | 0.5865 |         94312.24 |                736.8144 |          23.0254 | 29989098496 |             2097152 |                 512 |                  4 |         1 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |     128 | a100_80gb |
|  gpt30b |       4096 |  32xA100_80GB | 0.4245 | 0.4378 | 0.5660 | 0.5859 |         23553.76 |                736.0550 |           5.7504 | 29989098496 |              524288 |                 128 |                  4 |         1 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |      32 | a100_80gb |
|  gpt30b |       4096 |  16xA100_80GB | 0.4253 | 0.4386 | 0.5671 | 0.5870 |         11799.06 |                737.4413 |           2.8806 | 29989098496 |              262144 |                  64 |                  4 |         1 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |      16 | a100_80gb |
|  gpt30b |       2048 | 256xA100_80GB | 0.4464 | 0.4534 | 0.5952 | 0.6057 |        198267.62 |                774.4829 |          96.8104 | 29974418432 |             4194304 |                2048 |                  8 |         1 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |     256 | a100_80gb |
|  gpt30b |       2048 | 128xA100_80GB | 0.4548 | 0.4619 | 0.6064 | 0.6171 |        100995.65 |                789.0285 |          49.3143 | 29974418432 |             2097152 |                1024 |                  8 |         1 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |     128 | a100_80gb |
|  gpt30b |       2048 |  64xA100_80GB | 0.4562 | 0.4634 | 0.6083 | 0.6190 |         50651.59 |                791.4310 |          24.7322 | 29974418432 |             1048576 |                 512 |                  8 |         1 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |      64 | a100_80gb |
|  gpt30b |       2048 |  32xA100_80GB | 0.4580 | 0.4652 | 0.6107 | 0.6215 |         25427.85 |                794.6202 |          12.4159 | 29974418432 |              524288 |                 256 |                  8 |         1 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |      32 | a100_80gb |
|  gpt30b |       2048 |  16xA100_80GB | 0.4562 | 0.4634 | 0.6083 | 0.6190 |         12663.75 |                791.4842 |           6.1835 | 29974418432 |              262144 |                 128 |                  8 |         1 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |      16 | a100_80gb |
|  gpt13b |       8192 | 128xA100_80GB | 0.3316 | 0.3604 | 0.4421 | 0.4853 |        171301.11 |               1338.2899 |          20.9108 | 12884843520 |             2097152 |                 256 |                  2 |         1 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |     128 | a100_80gb |
|  gpt13b |       8192 |  64xA100_80GB | 0.3351 | 0.3642 | 0.4468 | 0.4904 |         86550.86 |               1352.3571 |          10.5653 | 12884843520 |             1048576 |                 128 |                  2 |         1 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |      64 | a100_80gb |
|  gpt13b |       8192 |  32xA100_80GB | 0.3382 | 0.3676 | 0.4510 | 0.4950 |         43682.94 |               1365.0918 |           5.3324 | 12884843520 |              524288 |                  64 |                  2 |         1 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |      32 | a100_80gb |
|  gpt13b |       8192 |  16xA100_80GB | 0.3362 | 0.3654 | 0.4483 | 0.4921 |         21710.52 |               1356.9075 |           2.6502 | 12884843520 |              262144 |                  32 |                  2 |         1 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |      16 | a100_80gb |
|  gpt13b |       4096 |  64xA100_80GB | 0.3906 | 0.4076 | 0.5208 | 0.5463 |        101058.89 |               1579.0451 |          24.6726 | 12863872000 |             1048576 |                 256 |                  4 |         1 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |      64 | a100_80gb |
|  gpt13b |       4096 |  32xA100_80GB | 0.3878 | 0.4047 | 0.5171 | 0.5424 |         50169.12 |               1567.7850 |          12.2483 | 12863872000 |              524288 |                 128 |                  4 |         1 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |      32 | a100_80gb |
|  gpt13b |       4096 |  16xA100_80GB | 0.3899 | 0.4069 | 0.5199 | 0.5453 |         25218.46 |               1576.1536 |           6.1569 | 12863872000 |              262144 |                  64 |                  4 |         1 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |      16 | a100_80gb |
|  gpt13b |       2048 | 128xA100_80GB | 0.4226 | 0.4318 | 0.5635 | 0.5773 |        218852.00 |               1709.7813 |         106.8613 | 12853386240 |             2097152 |                1024 |                  8 |         1 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |     128 | a100_80gb |
|  gpt13b |       2048 |  64xA100_80GB | 0.4251 | 0.4344 | 0.5668 | 0.5807 |        110076.33 |               1719.9427 |          53.7482 | 12853386240 |             1048576 |                 512 |                  8 |         1 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |      64 | a100_80gb |
|  gpt13b |       2048 |  32xA100_80GB | 0.4197 | 0.4288 | 0.5596 | 0.5733 |         54335.55 |               1697.9859 |          26.5310 | 12853386240 |              524288 |                 256 |                  8 |         1 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |      32 | a100_80gb |
|  gpt13b |       2048 |  16xA100_80GB | 0.4274 | 0.4367 | 0.5699 | 0.5838 |         27666.72 |               1729.1699 |          13.5091 | 12853386240 |              262144 |                 128 |                  8 |         1 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |      16 | a100_80gb |
|  gpt13b |      16384 |   8xA100_80GB | 0.2691 | 0.3157 | 0.3588 | 0.4286 |          8659.76 |               1082.4704 |           0.5285 | 12926786560 |             4194304 |                 256 |                  1 |        32 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |       8 | a100_80gb |
|  gpt13b |       8192 |   8xA100_80GB | 0.3424 | 0.3722 | 0.4566 | 0.5012 |         11055.68 |               1381.9597 |           1.3496 | 12884843520 |             4194304 |                 512 |                  2 |        32 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |       8 | a100_80gb |
|  gpt13b |       4096 |   8xA100_80GB | 0.3974 | 0.4146 | 0.5298 | 0.5557 |         12850.50 |               1606.3130 |           3.1373 | 12863872000 |             4194304 |                1024 |                  4 |        32 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |       8 | a100_80gb |
|  gpt13b |       2048 |   8xA100_80GB | 0.4304 | 0.4397 | 0.5738 | 0.5879 |         13929.35 |               1741.1686 |           6.8014 | 12853386240 |             4194304 |                2048 |                  8 |        32 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |       8 | a100_80gb |
|  gpt13b |       1024 |   8xA100_80GB | 0.4514 | 0.4563 | 0.6019 | 0.6092 |         14615.32 |               1826.9146 |          14.2728 | 12848143360 |             4194304 |                4096 |                 16 |        32 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |       8 | a100_80gb |
|  gpt13b |        512 |   8xA100_80GB | 0.4618 | 0.4643 | 0.6157 | 0.6195 |         14954.35 |               1869.2934 |          29.2077 | 12845521920 |             4194304 |                8192 |                 32 |        32 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |       8 | a100_80gb |
|  gpt13b |        512 |   8xA100_80GB | 0.4632 | 0.4657 | 0.6176 | 0.6214 |         15001.49 |               1875.1866 |          29.2998 | 12845521920 |              524288 |                1024 |                 32 |         4 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |       8 | a100_80gb |
|   gpt7b |      16384 |   8xA100_80GB | 0.2406 | 0.2919 | 0.3208 | 0.3978 |         14901.90 |               1862.7379 |           0.9095 |  6717124608 |             4194304 |                 256 |                  2 |        16 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |       8 | a100_80gb |
|   gpt7b |       8192 |   8xA100_80GB | 0.3120 | 0.3455 | 0.4161 | 0.4662 |         19422.58 |               2427.8221 |           2.3709 |  6683570176 |             4194304 |                 512 |                  4 |        16 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |       8 | a100_80gb |
|   gpt7b |       4096 |   8xA100_80GB | 0.3741 | 0.3942 | 0.4988 | 0.5289 |         23343.51 |               2917.9392 |           5.6991 |  6666792960 |             4194304 |                1024 |                  8 |        16 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |       8 | a100_80gb |
|   gpt7b |       2048 |   8xA100_80GB | 0.4106 | 0.4216 | 0.5474 | 0.5640 |         25651.12 |               3206.3898 |          12.5250 |  6658404352 |             4194304 |                2048 |                 16 |        16 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |       8 | a100_80gb |
|   gpt3b |      16384 |   8xA100_80GB | 0.1829 | 0.2437 | 0.2438 | 0.3351 |         28295.66 |               3536.9574 |           1.7270 |  2688253440 |             4194304 |                 256 |                  4 |         8 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |       8 | a100_80gb |
|   gpt3b |       8192 |   8xA100_80GB | 0.2522 | 0.2946 | 0.3363 | 0.3998 |         39341.83 |               4917.7293 |           4.8025 |  2667281920 |             4194304 |                 512 |                  8 |         8 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |       8 | a100_80gb |
|   gpt3b |       4096 |   8xA100_80GB | 0.3140 | 0.3405 | 0.4187 | 0.4584 |         49169.98 |               6146.2477 |          12.0044 |  2656796160 |             4194304 |                1024 |                 16 |         8 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |       8 | a100_80gb |
|   gpt3b |       2048 |   8xA100_80GB | 0.3551 | 0.3701 | 0.4735 | 0.4959 |         55710.27 |               6963.7837 |          27.2023 |  2651553280 |             4194304 |                2048 |                 32 |         8 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |       8 | a100_80gb |
|   gpt1b |      16384 |   8xA100_80GB | 0.1579 | 0.2210 | 0.2106 | 0.3051 |         48846.93 |               6105.8662 |           2.9814 |  1345083392 |             4194304 |                 256 |                  4 |         8 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |       8 | a100_80gb |
|   gpt1b |       8192 |   8xA100_80GB | 0.2206 | 0.2652 | 0.2942 | 0.3610 |         69094.52 |               8636.8154 |           8.4344 |  1328306176 |             4194304 |                 512 |                  8 |         8 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |       8 | a100_80gb |
|   gpt1b |       4096 |   8xA100_80GB | 0.2806 | 0.3091 | 0.3741 | 0.4169 |         88432.31 |              11054.0390 |          21.5899 |  1319917568 |             4194304 |                1024 |                 16 |         8 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |       8 | a100_80gb |
|   gpt1b |       2048 |   8xA100_80GB | 0.3187 | 0.3349 | 0.4249 | 0.4493 |        100751.50 |              12593.9379 |          49.1951 |  1315723264 |             4194304 |                2048 |                 32 |         8 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |       8 | a100_80gb |
| gpt760m |      16384 |   8xA100_80GB | 0.1741 | 0.2637 | 0.1741 | 0.2637 |         92578.78 |              11572.3469 |           5.6506 |   782320128 |             4194304 |                 256 |                  2 |        16 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |       8 | a100_80gb |
| gpt760m |       8192 |   8xA100_80GB | 0.2409 | 0.3039 | 0.2409 | 0.3039 |        130205.04 |              16275.6301 |          15.8942 |   769737216 |             4194304 |                 512 |                  4 |        16 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |       8 | a100_80gb |
| gpt760m |       4096 |   8xA100_80GB | 0.3045 | 0.3446 | 0.3045 | 0.3446 |        165901.89 |              20737.7357 |          40.5034 |   763445760 |             4194304 |                1024 |                  8 |        16 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |       8 | a100_80gb |
| gpt760m |       2048 |   8xA100_80GB | 0.3488 | 0.3718 | 0.3488 | 0.3718 |        190823.20 |              23852.8998 |          93.1754 |   760300032 |             4194304 |                2048 |                 16 |        16 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |       8 | a100_80gb |
| gpt350m |      16384 |   8xA100_80GB | 0.1465 | 0.2526 | 0.1465 | 0.2526 |        164446.54 |              20555.8170 |          10.0370 |   370551808 |             4194304 |                 256 |                  2 |        16 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |       8 | a100_80gb |
| gpt350m |       8192 |   8xA100_80GB | 0.2018 | 0.2766 | 0.2018 | 0.2766 |        231820.82 |              28977.6026 |          28.2984 |   362163200 |             4194304 |                 512 |                  4 |        16 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |       8 | a100_80gb |
| gpt350m |       4096 |   8xA100_80GB | 0.2497 | 0.2965 | 0.2497 | 0.2965 |        290135.04 |              36266.8800 |          70.8337 |   357968896 |             4194304 |                1024 |                  8 |        16 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |       8 | a100_80gb |
| gpt350m |       2048 |   8xA100_80GB | 0.2870 | 0.3141 | 0.2870 | 0.3141 |        335500.45 |              41937.5565 |         163.8186 |   355871744 |             4194304 |                2048 |                 16 |        16 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |       8 | a100_80gb |
| gpt125m |      16384 |   8xA100_80GB | 0.1266 | 0.2201 | 0.1266 | 0.2201 |        386517.07 |              48314.6342 |          23.5911 |   136236288 |             4194304 |                 256 |                  4 |         8 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |       8 | a100_80gb |
| gpt125m |       8192 |   8xA100_80GB | 0.1651 | 0.2290 | 0.1651 | 0.2290 |        528395.14 |              66049.3926 |          64.5014 |   129944832 |             4194304 |                 512 |                  8 |         8 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |       8 | a100_80gb |
| gpt125m |       4096 |   8xA100_80GB | 0.1983 | 0.2376 | 0.1983 | 0.2376 |        650554.90 |              81319.3626 |         158.8269 |   126799104 |             4194304 |                1024 |                 16 |         8 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |       8 | a100_80gb |
| gpt125m |       2048 |   8xA100_80GB | 0.2210 | 0.2433 | 0.2210 | 0.2433 |        734298.52 |              91787.3152 |         358.5442 |   125226240 |             4194304 |                2048 |                 32 |         8 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |       8 | a100_80gb |
| gpt125m |        512 |   8xA100_80GB | 0.2457 | 0.2519 | 0.2457 | 0.2519 |        823936.33 |             102992.0416 |        1609.2506 |   124046592 |             8388608 |               16384 |                128 |        16 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |       8 | a100_80gb |
| gpt125m |        512 |   8xA100_80GB | 0.2459 | 0.2521 | 0.2459 | 0.2521 |        824517.51 |             103064.6886 |        1610.3858 |   124046592 |             4194304 |                8192 |                128 |         8 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |       8 | a100_80gb |
| gpt125m |        512 |   8xA100_80GB | 0.2450 | 0.2512 | 0.2450 | 0.2512 |        821720.79 |             102715.0989 |        1604.9234 |   124046592 |             2097152 |                4096 |                128 |         4 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |       8 | a100_80gb |
| gpt125m |        512 |   8xA100_80GB | 0.2424 | 0.2486 | 0.2424 | 0.2486 |        813029.11 |             101628.6387 |        1587.9475 |   124046592 |             1048576 |                2048 |                128 |         2 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |       8 | a100_80gb |
| gpt125m |        512 |   8xA100_80GB | 0.2405 | 0.2466 | 0.2405 | 0.2466 |        806639.74 |             100829.9674 |        1575.4682 |   124046592 |              524288 |                1024 |                128 |         1 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |       8 | a100_80gb |

## A100 40GB

| Model   | SeqLen (T) | GPUType       | MFU*   | MFU    | HFU*   | HFU    | Throughput (T/s) | GPUThroughput (T/s/GPU) | Throughput (S/s) | ParamCount  | GlobalBatchSize (T) | GlobalBatchSize (S) | MicroBatchSize (S) | GradAccum | ShardStrategy | ActCkpt | ActCPUoffload | Precision | MP Mode | NumGPUs | GPUType   |
| ------- | ---------- | ------------- | ------ | ------ | ------ | ------ | ---------------- | ----------------------- | ---------------- | ----------- | ------------------- | ------------------- | ------------------ | --------- | ------------- | ------- | ------------- | --------- | ------- | ------- | --------- |
|   gpt7b |       8192 |   8xA100_40GB | 0.2836 | 0.3140 | 0.3782 | 0.4238 |         17654.50 |               2206.8122 |           2.1551 |  6683570176 |             8388608 |                1024 |                  1 |       128 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |       8 | a100_40gb |
|   gpt7b |       4096 |   8xA100_40GB | 0.3321 | 0.3500 | 0.4428 | 0.4696 |         20723.96 |               2590.4947 |           5.0596 |  6666792960 |             8388608 |                2048 |                  2 |       128 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |       8 | a100_40gb |
|   gpt7b |       2048 |   8xA100_40GB | 0.3628 | 0.3726 | 0.4838 | 0.4984 |         22668.72 |               2833.5898 |          11.0687 |  6658404352 |             8388608 |                4096 |                  4 |       128 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |       8 | a100_40gb |
|   gpt7b |       1024 |   8xA100_40GB | 0.3760 | 0.3811 | 0.5014 | 0.5089 |         23507.13 |               2938.3910 |          22.9562 |  6654210048 |             8388608 |                8192 |                  8 |       128 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |       8 | a100_40gb |
|   gpt7b |       1024 |   8xA100_40GB | 0.3782 | 0.3833 | 0.5043 | 0.5119 |         23644.47 |               2955.5584 |          23.0903 |  6654210048 |              524288 |                 512 |                  8 |         8 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |       8 | a100_40gb |
|   gpt3b |      16384 |   8xA100_40GB | 0.1754 | 0.2337 | 0.2338 | 0.3214 |         27136.33 |               3392.0410 |           1.6563 |  2688253440 |             8388608 |                 512 |                  1 |        64 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |       8 | a100_40gb |
|   gpt3b |       8192 |   8xA100_40GB | 0.2379 | 0.2778 | 0.3172 | 0.3771 |         37105.58 |               4638.1978 |           4.5295 |  2667281920 |             8388608 |                1024 |                  2 |        64 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |       8 | a100_40gb |
|   gpt3b |       4096 |   8xA100_40GB | 0.2925 | 0.3172 | 0.3901 | 0.4270 |         45806.55 |               5725.8189 |          11.1832 |  2656796160 |             8388608 |                2048 |                  4 |        64 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |       8 | a100_40gb |
|   gpt3b |       2048 |   8xA100_40GB | 0.3312 | 0.3452 | 0.4416 | 0.4626 |         51966.01 |               6495.7517 |          25.3740 |  2651553280 |             8388608 |                4096 |                  8 |        64 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |       8 | a100_40gb |
|   gpt1b |      16384 |   8xA100_40GB | 0.1551 | 0.2171 | 0.2069 | 0.2997 |         47981.69 |               5997.7114 |           2.9286 |  1345083392 |             8388608 |                 512 |                  2 |        32 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |       8 | a100_40gb |
|   gpt1b |       8192 |   8xA100_40GB | 0.2133 | 0.2564 | 0.2844 | 0.3491 |         66805.43 |               8350.6790 |           8.1550 |  1328306176 |             8388608 |                1024 |                  4 |        32 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |       8 | a100_40gb |
|   gpt1b |       4096 |   8xA100_40GB | 0.2684 | 0.2957 | 0.3579 | 0.3989 |         84606.61 |              10575.8259 |          20.6559 |  1319917568 |             8388608 |                2048 |                  8 |        32 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |       8 | a100_40gb |
|   gpt1b |       2048 |   8xA100_40GB | 0.3100 | 0.3258 | 0.4133 | 0.4370 |         98012.45 |              12251.5558 |          47.8576 |  1315723264 |             8388608 |                4096 |                 16 |        32 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |       8 | a100_40gb |
| gpt760m |      16384 |   8xA100_40GB | 0.1032 | 0.1564 | 0.1032 | 0.1564 |         54899.02 |               6862.3770 |           3.3508 |   782320128 |             8388608 |                 512 |                  1 |        64 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |       8 | a100_40gb |
| gpt760m |       8192 |   8xA100_40GB | 0.1180 | 0.1489 | 0.1180 | 0.1489 |         63777.75 |               7972.2189 |           7.7854 |   769737216 |             8388608 |                1024 |                  2 |        64 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |       8 | a100_40gb |
| gpt760m |       4096 |   8xA100_40GB | 0.1214 | 0.1374 | 0.1214 | 0.1374 |         66157.45 |               8269.6806 |          16.1517 |   763445760 |             8388608 |                2048 |                  4 |        64 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |       8 | a100_40gb |
| gpt760m |       2048 |   8xA100_40GB | 0.1315 | 0.1402 | 0.1315 | 0.1402 |         71955.35 |               8994.4192 |          35.1345 |   760300032 |             8388608 |                4096 |                  8 |        64 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |       8 | a100_40gb |
| gpt350m |      16384 |   8xA100_40GB | 0.1416 | 0.2442 | 0.1416 | 0.2442 |        158971.66 |              19871.4573 |           9.7029 |   370551808 |             8388608 |                 512 |                  1 |        64 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |       8 | a100_40gb |
| gpt350m |       8192 |   8xA100_40GB | 0.1913 | 0.2621 | 0.1913 | 0.2621 |        219697.73 |              27462.2157 |          26.8186 |   362163200 |             8388608 |                1024 |                  2 |        64 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |       8 | a100_40gb |
| gpt350m |       4096 |   8xA100_40GB | 0.2277 | 0.2704 | 0.2277 | 0.2704 |        264652.84 |              33081.6051 |          64.6125 |   357968896 |             8388608 |                2048 |                  4 |        64 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |       8 | a100_40gb |
| gpt350m |       2048 |   8xA100_40GB | 0.2612 | 0.2858 | 0.2612 | 0.2858 |        305320.04 |              38165.0048 |         149.0821 |   355871744 |             8388608 |                4096 |                  8 |        64 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |       8 | a100_40gb |
| gpt125m |      16384 |  32xA100_40GB | 0.1235 | 0.2148 | 0.1235 | 0.2148 |       1508631.35 |              47144.7296 |          92.0795 |   136236288 |             8388608 |                 512 |                  2 |         8 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |      32 | a100_40gb |
| gpt125m |      16384 |  16xA100_40GB | 0.1236 | 0.2150 | 0.1236 | 0.2150 |        755006.01 |              47187.8758 |          46.0819 |   136236288 |             8388608 |                 512 |                  2 |        16 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |      16 | a100_40gb |
| gpt125m |      16384 |   8xA100_40GB | 0.1251 | 0.2175 | 0.1251 | 0.2175 |        381870.41 |              47733.8010 |          23.3075 |   136236288 |             8388608 |                 512 |                  2 |        32 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |       8 | a100_40gb |
| gpt125m |       8192 |  32xA100_40GB | 0.1571 | 0.2179 | 0.1571 | 0.2179 |       2011647.84 |              62863.9949 |         245.5625 |   129944832 |             8388608 |                1024 |                  4 |         8 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |      32 | a100_40gb |
| gpt125m |       8192 |  16xA100_40GB | 0.1574 | 0.2184 | 0.1574 | 0.2184 |       1007915.17 |              62994.6982 |         123.0365 |   129944832 |             8388608 |                1024 |                  4 |        16 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |      16 | a100_40gb |
| gpt125m |       8192 |   8xA100_40GB | 0.1591 | 0.2207 | 0.1591 | 0.2207 |        509301.39 |              63662.6739 |          62.1706 |   129944832 |             8388608 |                1024 |                  4 |        32 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |       8 | a100_40gb |
| gpt125m |       4096 |  32xA100_40GB | 0.1827 | 0.2190 | 0.1827 | 0.2190 |       2398127.68 |              74941.4899 |         585.4804 |   126799104 |             8388608 |                2048 |                  8 |         8 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |      32 | a100_40gb |
| gpt125m |       4096 |  16xA100_40GB | 0.1837 | 0.2201 | 0.1837 | 0.2201 |       1205308.62 |              75331.7888 |         294.2648 |   126799104 |             8388608 |                2048 |                  8 |        16 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |      16 | a100_40gb |
| gpt125m |       4096 |   8xA100_40GB | 0.1856 | 0.2224 | 0.1856 | 0.2224 |        608896.66 |              76112.0819 |         148.6564 |   126799104 |             8388608 |                2048 |                  8 |        32 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |       8 | a100_40gb |
| gpt125m |       2048 |  32xA100_40GB | 0.1974 | 0.2173 | 0.1974 | 0.2173 |       2623400.76 |              81981.2736 |        1280.9574 |   125226240 |             8388608 |                4096 |                 16 |         8 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |      32 | a100_40gb |
| gpt125m |       2048 |  32xA100_40GB | 0.1974 | 0.2172 | 0.1974 | 0.2172 |       2622702.35 |              81959.4483 |        1280.6164 |   125226240 |             4194304 |                2048 |                 16 |         4 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |      32 | a100_40gb |
| gpt125m |       2048 |  32xA100_40GB | 0.1966 | 0.2164 | 0.1966 | 0.2164 |       2612726.56 |              81647.7050 |        1275.7454 |   125226240 |             2097152 |                1024 |                 16 |         2 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |      32 | a100_40gb |
| gpt125m |       2048 |  32xA100_40GB | 0.1370 | 0.1508 | 0.1370 | 0.1508 |       1820569.29 |              56892.7904 |         888.9498 |   125226240 |             1048576 |                 512 |                 16 |         1 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |      32 | a100_40gb |
| gpt125m |       2048 |  32xA100_40GB | 0.1765 | 0.1942 | 0.1765 | 0.1942 |       2345199.00 |              73287.4688 |        1145.1167 |   125226240 |              524288 |                 256 |                  8 |         1 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |      32 | a100_40gb |
| gpt125m |       2048 |  16xA100_40GB | 0.2000 | 0.2201 | 0.2000 | 0.2201 |       1328659.15 |              83041.1968 |         648.7594 |   125226240 |             8388608 |                4096 |                 16 |        16 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |      16 | a100_40gb |
| gpt125m |       2048 |  16xA100_40GB | 0.2005 | 0.2206 | 0.2005 | 0.2206 |       1331959.34 |              83247.4586 |         650.3708 |   125226240 |             4194304 |                2048 |                 16 |         8 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |      16 | a100_40gb |
| gpt125m |       2048 |  16xA100_40GB | 0.1998 | 0.2199 | 0.1998 | 0.2199 |       1327378.19 |              82961.1366 |         648.1339 |   125226240 |             2097152 |                1024 |                 16 |         4 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |      16 | a100_40gb |
| gpt125m |       2048 |  16xA100_40GB | 0.2006 | 0.2207 | 0.2006 | 0.2207 |       1332681.58 |              83292.5990 |         650.7234 |   125226240 |             1048576 |                 512 |                 16 |         2 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |      16 | a100_40gb |
| gpt125m |       2048 |  16xA100_40GB | 0.1872 | 0.2060 | 0.1872 | 0.2060 |       1243435.23 |              77714.7021 |         607.1461 |   125226240 |              524288 |                 256 |                 16 |         1 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |      16 | a100_40gb |
| gpt125m |       2048 |   8xA100_40GB | 0.2034 | 0.2239 | 0.2034 | 0.2239 |        675801.76 |              84475.2205 |         329.9813 |   125226240 |             8388608 |                4096 |                 16 |        32 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |       8 | a100_40gb |
| gpt125m |       2048 |   8xA100_40GB | 0.2048 | 0.2254 | 0.2048 | 0.2254 |        680334.85 |              85041.8560 |         332.1947 |   125226240 |             4194304 |                2048 |                 16 |        16 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |       8 | a100_40gb |
| gpt125m |       2048 |   8xA100_40GB | 0.2042 | 0.2247 | 0.2042 | 0.2247 |        678222.25 |              84777.7818 |         331.1632 |   125226240 |             2097152 |                1024 |                 16 |         8 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |       8 | a100_40gb |
| gpt125m |       2048 |   8xA100_40GB | 0.2049 | 0.2254 | 0.2049 | 0.2254 |        680544.62 |              85068.0781 |         332.2972 |   125226240 |             1048576 |                 512 |                 16 |         4 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |       8 | a100_40gb |
| gpt125m |       2048 |   8xA100_40GB | 0.2037 | 0.2242 | 0.2037 | 0.2242 |        676676.83 |              84584.6042 |         330.4086 |   125226240 |              524288 |                 256 |                 16 |         2 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |       8 | a100_40gb |
| gpt125m |       1024 |  32xA100_40GB | 0.2085 | 0.2190 | 0.2085 | 0.2190 |       2787507.69 |              87109.6154 |        2722.1755 |   124439808 |             8388608 |                8192 |                 32 |         8 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |      32 | a100_40gb |
| gpt125m |       1024 |  16xA100_40GB | 0.2106 | 0.2213 | 0.2106 | 0.2213 |       1408293.69 |              88018.3558 |        1375.2868 |   124439808 |             8388608 |                8192 |                 32 |        16 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |      16 | a100_40gb |
| gpt125m |       1024 |   8xA100_40GB | 0.2142 | 0.2251 | 0.2142 | 0.2251 |        716232.55 |              89529.0688 |         699.4458 |   124439808 |             8388608 |                8192 |                 32 |        32 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |       8 | a100_40gb |
| gpt125m |        512 |  32xA100_40GB | 0.2158 | 0.2213 | 0.2158 | 0.2213 |       2894919.52 |              90466.2350 |        5654.1397 |   124046592 |             8388608 |               16384 |                 64 |         8 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |      32 | a100_40gb |
| gpt125m |        512 |  16xA100_40GB | 0.2171 | 0.2227 | 0.2171 | 0.2227 |       1456440.82 |              91027.5510 |        2844.6110 |   124046592 |             8388608 |               16384 |                 64 |        16 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |      16 | a100_40gb |
| gpt125m |        512 |   8xA100_40GB | 0.2215 | 0.2271 | 0.2215 | 0.2271 |        742696.31 |              92837.0394 |        1450.5787 |   124046592 |             8388608 |               16384 |                 64 |        32 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |       8 | a100_40gb |
