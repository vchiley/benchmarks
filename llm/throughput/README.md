# MosaicGPT Throughput, MFU, and HFU
Throughput, MFU, and HFU for different sized MosaicGPT models trained on MCloud.
MFU and HFU are defined in https://arxiv.org/abs/2205.05198
All FLOP calculations do not include norm, act, and residual.

MFU approximation:
Using only the parameters, per token, each parameter is used for a MAC (2 FLOPS) per network operation. Neural Network training has 4 network operations: forward pass, backward pass, and computation of parameter gradient.
The attention mechanism also has a forward pass and backward pass where `attn_flops_per_seq = n_layers * 2 * (d_model * (seq_len**2))`.
```
flops_per_token = 2 * n_params
flops_per_seq = flops_per_token * seq_len
mfu* = 3 * flops_per_seq * throughput / (gpu_num * GPU_AVAILABLE_FLOPS)

attn_flops_per_seq = n_layers * 2 * (d_model * (seq_len**2))
mfu = (3 * flops_per_seq + 2 * attn_flops_per_seq) * throughput / (gpu_num * GPU_AVAILABLE_FLOPS)
```

HFU is approximated using the fact that the networks use checkpointing for activation recomputation. This effectively requires an extra forward pass through the network.
```
hfu* = 4 * flops_per_seq * throughput / (gpu_num * GPU_AVAILABLE_FLOPS)
hfu = (4 * flops_per_seq + 3 * attn_flops_per_seq) * throughput / (gpu_num * GPU_AVAILABLE_FLOPS)
```

These are approximations. Real HFU would be higher since it would include the FLOP usage of norm, act, residual, as well as account for ALL recomputation (the model uses FlashAttn which already does a recomputation in the fwd pass; in reality, the hfu attn multiplier should be 5 instaed of 3).

Below we highlight some of the configurations, but the full tables can be found in [full_tables](./full_tables.md)

## 8x A100 80GB

| Model   | SeqLen (T) | GlobalBatchSize (T) | GPUType       | Throughput (T/s) | MFU*   | MFU    | HFU*   | HFU    | GPUThroughput (T/s/GPU) | Throughput (S/s) | ParamCount  | ShardStrategy | ActCkpt | ActCPUoffload | GlobalBatchSize (S) | MicroBatchSize (S) | GradAccum | Precision | MP Mode | Cluster | NumGPUs | GPUType   |
| ------- | ---------- | ------------------- | ------------- | ---------------- | ------ | ------ | ------ | ------ | ----------------------- | ---------------- | ----------- | ------------- | ------- | ------------- | ------------------- | ------------------ | --------- | --------- | ------- | ------- | ------- | --------- |
|  gpt13b |      16384 |             4194304 |   8xA100_80GB |          8659.76 | 0.2691 | 0.3157 | 0.3588 | 0.4286 |               1082.4704 |           0.5285 | 12926786560 |    FULL_SHARD |    True |         False |                 256 |                  1 |        32 |  amp_bf16 | DEFAULT |    r1z1 |       8 | a100_80gb |
|  gpt13b |       8192 |             4194304 |   8xA100_80GB |         11055.68 | 0.3424 | 0.3722 | 0.4566 | 0.5012 |               1381.9597 |           1.3496 | 12884843520 |    FULL_SHARD |    True |         False |                 512 |                  2 |        32 |  amp_bf16 | DEFAULT |    r1z1 |       8 | a100_80gb |
|  gpt13b |       4096 |             4194304 |   8xA100_80GB |         12850.50 | 0.3974 | 0.4146 | 0.5298 | 0.5557 |               1606.3130 |           3.1373 | 12863872000 |    FULL_SHARD |    True |         False |                1024 |                  4 |        32 |  amp_bf16 | DEFAULT |    r1z1 |       8 | a100_80gb |
|  gpt13b |       2048 |             4194304 |   8xA100_80GB |         13929.35 | 0.4304 | 0.4397 | 0.5738 | 0.5879 |               1741.1686 |           6.8014 | 12853386240 |    FULL_SHARD |    True |         False |                2048 |                  8 |        32 |  amp_bf16 | DEFAULT |    r1z1 |       8 | a100_80gb |
|  gpt13b |       1024 |             4194304 |   8xA100_80GB |         14615.32 | 0.4514 | 0.4563 | 0.6019 | 0.6092 |               1826.9146 |          14.2728 | 12848143360 |    FULL_SHARD |    True |         False |                4096 |                 16 |        32 |  amp_bf16 | DEFAULT |    r1z1 |       8 | a100_80gb |
|  gpt13b |        512 |             4194304 |   8xA100_80GB |         14954.35 | 0.4618 | 0.4643 | 0.6157 | 0.6195 |               1869.2934 |          29.2077 | 12845521920 |    FULL_SHARD |    True |         False |                8192 |                 32 |        32 |  amp_bf16 | DEFAULT |    r1z1 |       8 | a100_80gb |
|  gpt13b |        512 |              524288 |   8xA100_80GB |         15001.49 | 0.4632 | 0.4657 | 0.6176 | 0.6214 |               1875.1866 |          29.2998 | 12845521920 |    FULL_SHARD |    True |         False |                1024 |                 32 |         4 |  amp_bf16 | DEFAULT |    r1z1 |       8 | a100_80gb |
|   gpt7b |      16384 |             4194304 |   8xA100_80GB |         14901.90 | 0.2406 | 0.2919 | 0.3208 | 0.3978 |               1862.7379 |           0.9095 |  6717124608 |    FULL_SHARD |    True |         False |                 256 |                  2 |        16 |  amp_bf16 | DEFAULT |    r1z1 |       8 | a100_80gb |
|   gpt7b |       8192 |             4194304 |   8xA100_80GB |         19422.58 | 0.3120 | 0.3455 | 0.4161 | 0.4662 |               2427.8221 |           2.3709 |  6683570176 |    FULL_SHARD |    True |         False |                 512 |                  4 |        16 |  amp_bf16 | DEFAULT |    r1z1 |       8 | a100_80gb |
|   gpt7b |       4096 |             4194304 |   8xA100_80GB |         23343.51 | 0.3741 | 0.3942 | 0.4988 | 0.5289 |               2917.9392 |           5.6991 |  6666792960 |    FULL_SHARD |    True |         False |                1024 |                  8 |        16 |  amp_bf16 | DEFAULT |    r1z1 |       8 | a100_80gb |
|   gpt7b |       2048 |             4194304 |   8xA100_80GB |         25651.12 | 0.4106 | 0.4216 | 0.5474 | 0.5640 |               3206.3898 |          12.5250 |  6658404352 |    FULL_SHARD |    True |         False |                2048 |                 16 |        16 |  amp_bf16 | DEFAULT |    r1z1 |       8 | a100_80gb |
|   gpt3b |      16384 |             4194304 |   8xA100_80GB |         28295.66 | 0.1829 | 0.2437 | 0.2438 | 0.3351 |               3536.9574 |           1.7270 |  2688253440 |    FULL_SHARD |    True |         False |                 256 |                  4 |         8 |  amp_bf16 | DEFAULT |    r1z1 |       8 | a100_80gb |
|   gpt3b |       8192 |             4194304 |   8xA100_80GB |         39341.83 | 0.2522 | 0.2946 | 0.3363 | 0.3998 |               4917.7293 |           4.8025 |  2667281920 |    FULL_SHARD |    True |         False |                 512 |                  8 |         8 |  amp_bf16 | DEFAULT |    r1z1 |       8 | a100_80gb |
|   gpt3b |       4096 |             4194304 |   8xA100_80GB |         49169.98 | 0.3140 | 0.3405 | 0.4187 | 0.4584 |               6146.2477 |          12.0044 |  2656796160 |    FULL_SHARD |    True |         False |                1024 |                 16 |         8 |  amp_bf16 | DEFAULT |    r1z1 |       8 | a100_80gb |
|   gpt3b |       2048 |             4194304 |   8xA100_80GB |         55710.27 | 0.3551 | 0.3701 | 0.4735 | 0.4959 |               6963.7837 |          27.2023 |  2651553280 |    FULL_SHARD |    True |         False |                2048 |                 32 |         8 |  amp_bf16 | DEFAULT |    r1z1 |       8 | a100_80gb |
|   gpt1b |      16384 |             4194304 |   8xA100_80GB |         48846.93 | 0.1579 | 0.2210 | 0.2106 | 0.3051 |               6105.8662 |           2.9814 |  1345083392 |    FULL_SHARD |    True |         False |                 256 |                  4 |         8 |  amp_bf16 | DEFAULT |    r1z1 |       8 | a100_80gb |
|   gpt1b |       8192 |             4194304 |   8xA100_80GB |         69094.52 | 0.2206 | 0.2652 | 0.2942 | 0.3610 |               8636.8154 |           8.4344 |  1328306176 |    FULL_SHARD |    True |         False |                 512 |                  8 |         8 |  amp_bf16 | DEFAULT |    r1z1 |       8 | a100_80gb |
|   gpt1b |       4096 |             4194304 |   8xA100_80GB |         88432.31 | 0.2806 | 0.3091 | 0.3741 | 0.4169 |              11054.0390 |          21.5899 |  1319917568 |    FULL_SHARD |    True |         False |                1024 |                 16 |         8 |  amp_bf16 | DEFAULT |    r1z1 |       8 | a100_80gb |
|   gpt1b |       2048 |             4194304 |   8xA100_80GB |        100751.50 | 0.3187 | 0.3349 | 0.4249 | 0.4493 |              12593.9379 |          49.1951 |  1315723264 |    FULL_SHARD |    True |         False |                2048 |                 32 |         8 |  amp_bf16 | DEFAULT |    r1z1 |       8 | a100_80gb |
| gpt760m |      16384 |             4194304 |   8xA100_80GB |         92578.78 | 0.1741 | 0.2637 | 0.1741 | 0.2637 |              11572.3469 |           5.6506 |   782320128 |    FULL_SHARD |   False |         False |                 256 |                  2 |        16 |  amp_bf16 | DEFAULT |    r1z1 |       8 | a100_80gb |
| gpt760m |       8192 |             4194304 |   8xA100_80GB |        130205.04 | 0.2409 | 0.3039 | 0.2409 | 0.3039 |              16275.6301 |          15.8942 |   769737216 |    FULL_SHARD |   False |         False |                 512 |                  4 |        16 |  amp_bf16 | DEFAULT |    r1z1 |       8 | a100_80gb |
| gpt760m |       4096 |             4194304 |   8xA100_80GB |        165901.89 | 0.3045 | 0.3446 | 0.3045 | 0.3446 |              20737.7357 |          40.5034 |   763445760 |    FULL_SHARD |   False |         False |                1024 |                  8 |        16 |  amp_bf16 | DEFAULT |    r1z1 |       8 | a100_80gb |
| gpt760m |       2048 |             4194304 |   8xA100_80GB |        190823.20 | 0.3488 | 0.3718 | 0.3488 | 0.3718 |              23852.8998 |          93.1754 |   760300032 |    FULL_SHARD |   False |         False |                2048 |                 16 |        16 |  amp_bf16 | DEFAULT |    r1z1 |       8 | a100_80gb |
| gpt350m |      16384 |             4194304 |   8xA100_80GB |        164446.54 | 0.1465 | 0.2526 | 0.1465 | 0.2526 |              20555.8170 |          10.0370 |   370551808 |    FULL_SHARD |   False |         False |                 256 |                  2 |        16 |  amp_bf16 | DEFAULT |    r1z1 |       8 | a100_80gb |
| gpt350m |       8192 |             4194304 |   8xA100_80GB |        231820.82 | 0.2018 | 0.2766 | 0.2018 | 0.2766 |              28977.6026 |          28.2984 |   362163200 |    FULL_SHARD |   False |         False |                 512 |                  4 |        16 |  amp_bf16 | DEFAULT |    r1z1 |       8 | a100_80gb |
| gpt350m |       4096 |             4194304 |   8xA100_80GB |        290135.04 | 0.2497 | 0.2965 | 0.2497 | 0.2965 |              36266.8800 |          70.8337 |   357968896 |    FULL_SHARD |   False |         False |                1024 |                  8 |        16 |  amp_bf16 | DEFAULT |    r1z1 |       8 | a100_80gb |
| gpt350m |       2048 |             4194304 |   8xA100_80GB |        335500.45 | 0.2870 | 0.3141 | 0.2870 | 0.3141 |              41937.5565 |         163.8186 |   355871744 |    FULL_SHARD |   False |         False |                2048 |                 16 |        16 |  amp_bf16 | DEFAULT |    r1z1 |       8 | a100_80gb |
| gpt125m |      16384 |             4194304 |   8xA100_80GB |        386517.07 | 0.1266 | 0.2201 | 0.1266 | 0.2201 |              48314.6342 |          23.5911 |   136236288 |    FULL_SHARD |   False |         False |                 256 |                  4 |         8 |  amp_bf16 | DEFAULT |    r1z1 |       8 | a100_80gb |
| gpt125m |       8192 |             4194304 |   8xA100_80GB |        528395.14 | 0.1651 | 0.2290 | 0.1651 | 0.2290 |              66049.3926 |          64.5014 |   129944832 |    FULL_SHARD |   False |         False |                 512 |                  8 |         8 |  amp_bf16 | DEFAULT |    r1z1 |       8 | a100_80gb |
| gpt125m |       4096 |             4194304 |   8xA100_80GB |        650554.90 | 0.1983 | 0.2376 | 0.1983 | 0.2376 |              81319.3626 |         158.8269 |   126799104 |    FULL_SHARD |   False |         False |                1024 |                 16 |         8 |  amp_bf16 | DEFAULT |    r1z1 |       8 | a100_80gb |
| gpt125m |       2048 |             4194304 |   8xA100_80GB |        734298.52 | 0.2210 | 0.2433 | 0.2210 | 0.2433 |              91787.3152 |         358.5442 |   125226240 |    FULL_SHARD |   False |         False |                2048 |                 32 |         8 |  amp_bf16 | DEFAULT |    r1z1 |       8 | a100_80gb |
| gpt125m |       1024 |             4194304 |   8xA100_80GB |        789281.02 | 0.2361 | 0.2480 | 0.2361 | 0.2480 |              98660.1280 |         770.7822 |   124439808 |    FULL_SHARD |   False |         False |                4096 |                 64 |         8 |  amp_bf16 | DEFAULT |    r1z1 |       8 | a100_80gb |
| gpt125m |        512 |             8388608 |   8xA100_80GB |        823936.33 | 0.2457 | 0.2519 | 0.2457 | 0.2519 |             102992.0416 |        1609.2506 |   124046592 |    FULL_SHARD |   False |         False |               16384 |                128 |        16 |  amp_bf16 | DEFAULT |    r1z1 |       8 | a100_80gb |
| gpt125m |        512 |             4194304 |   8xA100_80GB |        824517.51 | 0.2459 | 0.2521 | 0.2459 | 0.2521 |             103064.6886 |        1610.3858 |   124046592 |    FULL_SHARD |   False |         False |                8192 |                128 |         8 |  amp_bf16 | DEFAULT |    r1z1 |       8 | a100_80gb |
| gpt125m |        512 |             2097152 |   8xA100_80GB |        821720.79 | 0.2450 | 0.2512 | 0.2450 | 0.2512 |             102715.0989 |        1604.9234 |   124046592 |    FULL_SHARD |   False |         False |                4096 |                128 |         4 |  amp_bf16 | DEFAULT |    r1z1 |       8 | a100_80gb |
| gpt125m |        512 |             1048576 |   8xA100_80GB |        813029.11 | 0.2424 | 0.2486 | 0.2424 | 0.2486 |             101628.6387 |        1587.9475 |   124046592 |    FULL_SHARD |   False |         False |                2048 |                128 |         2 |  amp_bf16 | DEFAULT |    r1z1 |       8 | a100_80gb |
| gpt125m |        512 |              524288 |   8xA100_80GB |        806639.74 | 0.2405 | 0.2466 | 0.2405 | 0.2466 |             100829.9674 |        1575.4682 |   124046592 |    FULL_SHARD |   False |         False |                1024 |                128 |         1 |  amp_bf16 | DEFAULT |    r1z1 |       8 | a100_80gb |

## 8x to 64x A100 40GB

| Model   | SeqLen (T) | GlobalBatchSize (T) | GPUType       | Throughput (T/s) | MFU*   | MFU    | HFU*   | HFU    | GPUThroughput (T/s/GPU) | Throughput (S/s) | ParamCount  | ShardStrategy | ActCkpt | ActCPUoffload | GlobalBatchSize (S) | MicroBatchSize (S) | GradAccum | Precision | MP Mode | Cluster | NumGPUs | GPUType   |
| ------- | ---------- | ------------------- | ------------- | ---------------- | ------ | ------ | ------ | ------ | ----------------------- | ---------------- | ----------- | ------------- | ------- | ------------- | ------------------- | ------------------ | --------- | --------- | ------- | ------- | ------- | --------- |
|   gpt7b |       8192 |             8388608 |   8xA100_40GB |         17654.50 | 0.2836 | 0.3140 | 0.3782 | 0.4238 |               2206.8122 |           2.1551 |  6683570176 |    FULL_SHARD |    True |         False |                1024 |                  1 |       128 |  amp_bf16 | DEFAULT |    r7z2 |       8 | a100_40gb |
|   gpt7b |       4096 |             8388608 |   8xA100_40GB |         20723.96 | 0.3321 | 0.3500 | 0.4428 | 0.4696 |               2590.4947 |           5.0596 |  6666792960 |    FULL_SHARD |    True |         False |                2048 |                  2 |       128 |  amp_bf16 | DEFAULT |    r7z2 |       8 | a100_40gb |
|   gpt7b |       2048 |             8388608 |   8xA100_40GB |         22668.72 | 0.3628 | 0.3726 | 0.4838 | 0.4984 |               2833.5898 |          11.0687 |  6658404352 |    FULL_SHARD |    True |         False |                4096 |                  4 |       128 |  amp_bf16 | DEFAULT |    r7z2 |       8 | a100_40gb |
|   gpt7b |       1024 |             8388608 |   8xA100_40GB |         23507.13 | 0.3760 | 0.3811 | 0.5014 | 0.5089 |               2938.3910 |          22.9562 |  6654210048 |    FULL_SHARD |    True |         False |                8192 |                  8 |       128 |  amp_bf16 | DEFAULT |    r7z2 |       8 | a100_40gb |
|   gpt7b |       1024 |              524288 |   8xA100_40GB |         23644.47 | 0.3782 | 0.3833 | 0.5043 | 0.5119 |               2955.5584 |          23.0903 |  6654210048 |    FULL_SHARD |    True |         False |                 512 |                  8 |         8 |  amp_bf16 | DEFAULT |    r7z2 |       8 | a100_40gb |
|   gpt3b |      16384 |             8388608 |   8xA100_40GB |         27136.33 | 0.1754 | 0.2337 | 0.2338 | 0.3214 |               3392.0410 |           1.6563 |  2688253440 |    FULL_SHARD |    True |         False |                 512 |                  1 |        64 |  amp_bf16 | DEFAULT |    r7z2 |       8 | a100_40gb |
|   gpt3b |       8192 |             8388608 |   8xA100_40GB |         37105.58 | 0.2379 | 0.2778 | 0.3172 | 0.3771 |               4638.1978 |           4.5295 |  2667281920 |    FULL_SHARD |    True |         False |                1024 |                  2 |        64 |  amp_bf16 | DEFAULT |    r7z2 |       8 | a100_40gb |
|   gpt3b |       4096 |             8388608 |   8xA100_40GB |         45806.55 | 0.2925 | 0.3172 | 0.3901 | 0.4270 |               5725.8189 |          11.1832 |  2656796160 |    FULL_SHARD |    True |         False |                2048 |                  4 |        64 |  amp_bf16 | DEFAULT |    r7z2 |       8 | a100_40gb |
|   gpt3b |       2048 |             8388608 |   8xA100_40GB |         51966.01 | 0.3312 | 0.3452 | 0.4416 | 0.4626 |               6495.7517 |          25.3740 |  2651553280 |    FULL_SHARD |    True |         False |                4096 |                  8 |        64 |  amp_bf16 | DEFAULT |    r7z2 |       8 | a100_40gb |
|   gpt1b |      16384 |             8388608 |   8xA100_40GB |         47981.69 | 0.1551 | 0.2171 | 0.2069 | 0.2997 |               5997.7114 |           2.9286 |  1345083392 |    FULL_SHARD |    True |         False |                 512 |                  2 |        32 |  amp_bf16 | DEFAULT |    r7z2 |       8 | a100_40gb |
|   gpt1b |       8192 |             8388608 |   8xA100_40GB |         66805.43 | 0.2133 | 0.2564 | 0.2844 | 0.3491 |               8350.6790 |           8.1550 |  1328306176 |    FULL_SHARD |    True |         False |                1024 |                  4 |        32 |  amp_bf16 | DEFAULT |    r7z2 |       8 | a100_40gb |
|   gpt1b |       4096 |             8388608 |   8xA100_40GB |         84606.61 | 0.2684 | 0.2957 | 0.3579 | 0.3989 |              10575.8259 |          20.6559 |  1319917568 |    FULL_SHARD |    True |         False |                2048 |                  8 |        32 |  amp_bf16 | DEFAULT |    r7z2 |       8 | a100_40gb |
|   gpt1b |       2048 |             8388608 |   8xA100_40GB |         98012.45 | 0.3100 | 0.3258 | 0.4133 | 0.4370 |              12251.5558 |          47.8576 |  1315723264 |    FULL_SHARD |    True |         False |                4096 |                 16 |        32 |  amp_bf16 | DEFAULT |    r7z2 |       8 | a100_40gb |
| gpt760m |      16384 |             8388608 |   8xA100_40GB |         54899.02 | 0.1032 | 0.1564 | 0.1032 | 0.1564 |               6862.3770 |           3.3508 |   782320128 |    FULL_SHARD |   False |         False |                 512 |                  1 |        64 |  amp_bf16 | DEFAULT |    r7z2 |       8 | a100_40gb |
| gpt760m |       8192 |             8388608 |   8xA100_40GB |         63777.75 | 0.1180 | 0.1489 | 0.1180 | 0.1489 |               7972.2189 |           7.7854 |   769737216 |    FULL_SHARD |   False |         False |                1024 |                  2 |        64 |  amp_bf16 | DEFAULT |    r7z2 |       8 | a100_40gb |
| gpt760m |       4096 |             8388608 |   8xA100_40GB |         66157.45 | 0.1214 | 0.1374 | 0.1214 | 0.1374 |               8269.6806 |          16.1517 |   763445760 |    FULL_SHARD |   False |         False |                2048 |                  4 |        64 |  amp_bf16 | DEFAULT |    r7z2 |       8 | a100_40gb |
| gpt760m |       2048 |             8388608 |   8xA100_40GB |         71955.35 | 0.1315 | 0.1402 | 0.1315 | 0.1402 |               8994.4192 |          35.1345 |   760300032 |    FULL_SHARD |   False |         False |                4096 |                  8 |        64 |  amp_bf16 | DEFAULT |    r7z2 |       8 | a100_40gb |
| gpt350m |      16384 |             8388608 |   8xA100_40GB |        158971.66 | 0.1416 | 0.2442 | 0.1416 | 0.2442 |              19871.4573 |           9.7029 |   370551808 |    FULL_SHARD |   False |         False |                 512 |                  1 |        64 |  amp_bf16 | DEFAULT |    r7z2 |       8 | a100_40gb |
| gpt350m |       8192 |             8388608 |   8xA100_40GB |        219697.73 | 0.1913 | 0.2621 | 0.1913 | 0.2621 |              27462.2157 |          26.8186 |   362163200 |    FULL_SHARD |   False |         False |                1024 |                  2 |        64 |  amp_bf16 | DEFAULT |    r7z2 |       8 | a100_40gb |
| gpt350m |       4096 |             8388608 |   8xA100_40GB |        264652.84 | 0.2277 | 0.2704 | 0.2277 | 0.2704 |              33081.6051 |          64.6125 |   357968896 |    FULL_SHARD |   False |         False |                2048 |                  4 |        64 |  amp_bf16 | DEFAULT |    r7z2 |       8 | a100_40gb |
| gpt350m |       2048 |             8388608 |   8xA100_40GB |        305320.04 | 0.2612 | 0.2858 | 0.2612 | 0.2858 |              38165.0048 |         149.0821 |   355871744 |    FULL_SHARD |   False |         False |                4096 |                  8 |        64 |  amp_bf16 | DEFAULT |    r7z2 |       8 | a100_40gb |
| gpt125m |      16384 |             8388608 |  32xA100_40GB |       1508631.35 | 0.1235 | 0.2148 | 0.1235 | 0.2148 |              47144.7296 |          92.0795 |   136236288 |    FULL_SHARD |   False |         False |                 512 |                  2 |         8 |  amp_bf16 | DEFAULT |    r7z2 |      32 | a100_40gb |
| gpt125m |      16384 |             8388608 |  16xA100_40GB |        755006.01 | 0.1236 | 0.2150 | 0.1236 | 0.2150 |              47187.8758 |          46.0819 |   136236288 |    FULL_SHARD |   False |         False |                 512 |                  2 |        16 |  amp_bf16 | DEFAULT |    r7z2 |      16 | a100_40gb |
| gpt125m |      16384 |             8388608 |   8xA100_40GB |        381870.41 | 0.1251 | 0.2175 | 0.1251 | 0.2175 |              47733.8010 |          23.3075 |   136236288 |    FULL_SHARD |   False |         False |                 512 |                  2 |        32 |  amp_bf16 | DEFAULT |    r7z2 |       8 | a100_40gb |
| gpt125m |       8192 |             8388608 |  32xA100_40GB |       2011647.84 | 0.1571 | 0.2179 | 0.1571 | 0.2179 |              62863.9949 |         245.5625 |   129944832 |    FULL_SHARD |   False |         False |                1024 |                  4 |         8 |  amp_bf16 | DEFAULT |    r7z2 |      32 | a100_40gb |
| gpt125m |       8192 |             8388608 |  16xA100_40GB |       1007915.17 | 0.1574 | 0.2184 | 0.1574 | 0.2184 |              62994.6982 |         123.0365 |   129944832 |    FULL_SHARD |   False |         False |                1024 |                  4 |        16 |  amp_bf16 | DEFAULT |    r7z2 |      16 | a100_40gb |
| gpt125m |       8192 |             8388608 |   8xA100_40GB |        509301.39 | 0.1591 | 0.2207 | 0.1591 | 0.2207 |              63662.6739 |          62.1706 |   129944832 |    FULL_SHARD |   False |         False |                1024 |                  4 |        32 |  amp_bf16 | DEFAULT |    r7z2 |       8 | a100_40gb |
| gpt125m |       4096 |             8388608 |  32xA100_40GB |       2398127.68 | 0.1827 | 0.2190 | 0.1827 | 0.2190 |              74941.4899 |         585.4804 |   126799104 |    FULL_SHARD |   False |         False |                2048 |                  8 |         8 |  amp_bf16 | DEFAULT |    r7z2 |      32 | a100_40gb |
| gpt125m |       4096 |             8388608 |  16xA100_40GB |       1205308.62 | 0.1837 | 0.2201 | 0.1837 | 0.2201 |              75331.7888 |         294.2648 |   126799104 |    FULL_SHARD |   False |         False |                2048 |                  8 |        16 |  amp_bf16 | DEFAULT |    r7z2 |      16 | a100_40gb |
| gpt125m |       4096 |             8388608 |   8xA100_40GB |        608896.66 | 0.1856 | 0.2224 | 0.1856 | 0.2224 |              76112.0819 |         148.6564 |   126799104 |    FULL_SHARD |   False |         False |                2048 |                  8 |        32 |  amp_bf16 | DEFAULT |    r7z2 |       8 | a100_40gb |
| gpt125m |       2048 |             8388608 |  32xA100_40GB |       2623400.76 | 0.1974 | 0.2173 | 0.1974 | 0.2173 |              81981.2736 |        1280.9574 |   125226240 |    FULL_SHARD |   False |         False |                4096 |                 16 |         8 |  amp_bf16 | DEFAULT |    r7z2 |      32 | a100_40gb |
| gpt125m |       2048 |             4194304 |  32xA100_40GB |       2622702.35 | 0.1974 | 0.2172 | 0.1974 | 0.2172 |              81959.4483 |        1280.6164 |   125226240 |    FULL_SHARD |   False |         False |                2048 |                 16 |         4 |  amp_bf16 | DEFAULT |    r7z2 |      32 | a100_40gb |
| gpt125m |       2048 |             2097152 |  32xA100_40GB |       2612726.56 | 0.1966 | 0.2164 | 0.1966 | 0.2164 |              81647.7050 |        1275.7454 |   125226240 |    FULL_SHARD |   False |         False |                1024 |                 16 |         2 |  amp_bf16 | DEFAULT |    r7z2 |      32 | a100_40gb |
| gpt125m |       2048 |             1048576 |  32xA100_40GB |       1820569.29 | 0.1370 | 0.1508 | 0.1370 | 0.1508 |              56892.7904 |         888.9498 |   125226240 |    FULL_SHARD |   False |         False |                 512 |                 16 |         1 |  amp_bf16 | DEFAULT |    r7z2 |      32 | a100_40gb |
| gpt125m |       2048 |              524288 |  32xA100_40GB |       2345199.00 | 0.1765 | 0.1942 | 0.1765 | 0.1942 |              73287.4688 |        1145.1167 |   125226240 |    FULL_SHARD |   False |         False |                 256 |                  8 |         1 |  amp_bf16 | DEFAULT |    r7z2 |      32 | a100_40gb |
| gpt125m |       2048 |             8388608 |  16xA100_40GB |       1328659.15 | 0.2000 | 0.2201 | 0.2000 | 0.2201 |              83041.1968 |         648.7594 |   125226240 |    FULL_SHARD |   False |         False |                4096 |                 16 |        16 |  amp_bf16 | DEFAULT |    r7z2 |      16 | a100_40gb |
| gpt125m |       2048 |             4194304 |  16xA100_40GB |       1331959.34 | 0.2005 | 0.2206 | 0.2005 | 0.2206 |              83247.4586 |         650.3708 |   125226240 |    FULL_SHARD |   False |         False |                2048 |                 16 |         8 |  amp_bf16 | DEFAULT |    r7z2 |      16 | a100_40gb |
| gpt125m |       2048 |             2097152 |  16xA100_40GB |       1327378.19 | 0.1998 | 0.2199 | 0.1998 | 0.2199 |              82961.1366 |         648.1339 |   125226240 |    FULL_SHARD |   False |         False |                1024 |                 16 |         4 |  amp_bf16 | DEFAULT |    r7z2 |      16 | a100_40gb |
| gpt125m |       2048 |             1048576 |  16xA100_40GB |       1332681.58 | 0.2006 | 0.2207 | 0.2006 | 0.2207 |              83292.5990 |         650.7234 |   125226240 |    FULL_SHARD |   False |         False |                 512 |                 16 |         2 |  amp_bf16 | DEFAULT |    r7z2 |      16 | a100_40gb |
| gpt125m |       2048 |              524288 |  16xA100_40GB |       1243435.23 | 0.1872 | 0.2060 | 0.1872 | 0.2060 |              77714.7021 |         607.1461 |   125226240 |    FULL_SHARD |   False |         False |                 256 |                 16 |         1 |  amp_bf16 | DEFAULT |    r7z2 |      16 | a100_40gb |
| gpt125m |       2048 |             8388608 |   8xA100_40GB |        675801.76 | 0.2034 | 0.2239 | 0.2034 | 0.2239 |              84475.2205 |         329.9813 |   125226240 |    FULL_SHARD |   False |         False |                4096 |                 16 |        32 |  amp_bf16 | DEFAULT |    r7z2 |       8 | a100_40gb |
| gpt125m |       2048 |             4194304 |   8xA100_40GB |        680334.85 | 0.2048 | 0.2254 | 0.2048 | 0.2254 |              85041.8560 |         332.1947 |   125226240 |    FULL_SHARD |   False |         False |                2048 |                 16 |        16 |  amp_bf16 | DEFAULT |    r7z2 |       8 | a100_40gb |
| gpt125m |       2048 |             2097152 |   8xA100_40GB |        678222.25 | 0.2042 | 0.2247 | 0.2042 | 0.2247 |              84777.7818 |         331.1632 |   125226240 |    FULL_SHARD |   False |         False |                1024 |                 16 |         8 |  amp_bf16 | DEFAULT |    r7z2 |       8 | a100_40gb |
| gpt125m |       2048 |             1048576 |   8xA100_40GB |        680544.62 | 0.2049 | 0.2254 | 0.2049 | 0.2254 |              85068.0781 |         332.2972 |   125226240 |    FULL_SHARD |   False |         False |                 512 |                 16 |         4 |  amp_bf16 | DEFAULT |    r7z2 |       8 | a100_40gb |
| gpt125m |       2048 |              524288 |   8xA100_40GB |        676676.83 | 0.2037 | 0.2242 | 0.2037 | 0.2242 |              84584.6042 |         330.4086 |   125226240 |    FULL_SHARD |   False |         False |                 256 |                 16 |         2 |  amp_bf16 | DEFAULT |    r7z2 |       8 | a100_40gb |
| gpt125m |       1024 |             8388608 |  32xA100_40GB |       2787507.69 | 0.2085 | 0.2190 | 0.2085 | 0.2190 |              87109.6154 |        2722.1755 |   124439808 |    FULL_SHARD |   False |         False |                8192 |                 32 |         8 |  amp_bf16 | DEFAULT |    r7z2 |      32 | a100_40gb |
| gpt125m |       1024 |             8388608 |  16xA100_40GB |       1408293.69 | 0.2106 | 0.2213 | 0.2106 | 0.2213 |              88018.3558 |        1375.2868 |   124439808 |    FULL_SHARD |   False |         False |                8192 |                 32 |        16 |  amp_bf16 | DEFAULT |    r7z2 |      16 | a100_40gb |
| gpt125m |       1024 |             8388608 |   8xA100_40GB |        716232.55 | 0.2142 | 0.2251 | 0.2142 | 0.2251 |              89529.0688 |         699.4458 |   124439808 |    FULL_SHARD |   False |         False |                8192 |                 32 |        32 |  amp_bf16 | DEFAULT |    r7z2 |       8 | a100_40gb |
| gpt125m |        512 |             8388608 |  32xA100_40GB |       2894919.52 | 0.2158 | 0.2213 | 0.2158 | 0.2213 |              90466.2350 |        5654.1397 |   124046592 |    FULL_SHARD |   False |         False |               16384 |                 64 |         8 |  amp_bf16 | DEFAULT |    r7z2 |      32 | a100_40gb |
| gpt125m |        512 |             8388608 |  16xA100_40GB |       1456440.82 | 0.2171 | 0.2227 | 0.2171 | 0.2227 |              91027.5510 |        2844.6110 |   124046592 |    FULL_SHARD |   False |         False |               16384 |                 64 |        16 |  amp_bf16 | DEFAULT |    r7z2 |      16 | a100_40gb |
| gpt125m |        512 |             8388608 |   8xA100_40GB |        742696.31 | 0.2215 | 0.2271 | 0.2215 | 0.2271 |              92837.0394 |        1450.5787 |   124046592 |    FULL_SHARD |   False |         False |               16384 |                 64 |        32 |  amp_bf16 | DEFAULT |    r7z2 |       8 | a100_40gb |
